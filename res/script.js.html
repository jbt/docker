<!DOCTYPE html>
<html>
<head>
  <title>script.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = '../', thisFile = 'res/script.js';
  </script>
  <script src="../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#res-script.js">res/script.js</a>
      </div>
      <div class="heading h2">
        <a href="#maketree">makeTree</a>
      </div>
      <div class="heading h2">
        <a href="#treescrolled">treeScrolled</a>
      </div>
      <div class="heading h2">
        <a href="#nodeclicked">nodeClicked</a>
      </div>
      <div class="heading h2">
        <a href="#nodehtml">nodeHtml</a>
      </div>
      <div class="heading h2">
        <a href="#toggletree">toggleTree</a>
      </div>
      <div class="heading h2">
        <a href="#wireuptabs">wireUpTabs</a>
      </div>
      <div class="heading h2">
        <a href="#switchtab">switchTab</a>
      </div>
      <div class="heading h2">
        <a href="#window.onload">window.onload</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
<div class="pilwrap" id="res-script.js">
  <h1>
    <a href="#res-script.js" class="pilcrow">&#182;</a>
    res/script.js
  </h1>
</div>


<p>This is the script file that gets copied into the output. It mainly manages the display
of the folder tree. The idea of this script file is to be minimal and standalone. So
that means no jQuery.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>Use localStorage to store data about the tree's state: whether or not
the tree is visible and which directories are expanded</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">treeVisible</span> <span class="o">=</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_showTree</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">);</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="maketree">
  <h2>
    <a href="#maketree" class="pilcrow">&#182;</a>
    makeTree
  </h2>
</div>

  </div>
  <div class="body"><p>Consructs the folder tree view</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>treeData</span>
      <span class="dox_type">object</span>
      <span>Folder structure as in <a href="../src/docker.js.html#docker.prototype.queuefile">queueFile</a></span>
    </div>
    <div class="dox_tag_detail">
      <span>root</span>
      <span class="dox_type">string</span>
      <span>Path from current file to root (ie <code>'../../'</code> etc.)</span>
    </div>
    <div class="dox_tag_detail">
      <span>filename</span>
      <span class="dox_type">string</span>
      <span>The current file name</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">makeTree</span><span class="p">(</span><span class="nx">treeData</span><span class="p">,</span> <span class="nx">root</span><span class="p">,</span> <span class="nx">filename</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">treeNode</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;tree&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">treeHandle</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;sidebar-toggle&#39;</span><span class="p">);</span>
  <span class="nx">treeHandle</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">toggleTree</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>Build the html and add it to the container.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">treeNode</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">nodeHtml</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">treeData</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">root</span><span class="p">);</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>Root folder (whole tree) should always be open</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">treeNode</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; open&#39;</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>Attach click event handler</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">treeNode</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">nodeClicked</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">treeVisible</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; tree&#39;</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>Restore scroll position from localStorage if set. And attach scroll handler</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_treeScroll</span><span class="p">)</span> <span class="nx">treeNode</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_treeScroll</span><span class="p">;</span>
  <span class="nx">treeNode</span><span class="p">.</span><span class="nx">onscroll</span> <span class="o">=</span> <span class="nx">treeScrolled</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>Only set a class to allow CSS transitions after the tree state has been painted</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; slidey&#39;</span><span class="p">;</span> <span class="p">},</span> <span class="mi">100</span><span class="p">);</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="treescrolled">
  <h2>
    <a href="#treescrolled" class="pilcrow">&#182;</a>
    treeScrolled
  </h2>
</div>

  </div>
  <div class="body"><p>Called when the tree is scrolled. Stores the scroll position in localStorage
so it can be restored on the next pageview.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">treeScrolled</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;tree&#39;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">)</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_treeScroll</span> <span class="o">=</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="nodeclicked">
  <h2>
    <a href="#nodeclicked" class="pilcrow">&#182;</a>
    nodeClicked
  </h2>
</div>

  </div>
  <div class="body"><p>Called when a directory is clicked. Toggles open state of the directory</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>e</span>
      <span class="dox_type">Event</span>
      <span>The click event</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">nodeClicked</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>Find the target</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>If the click target is actually a file (rather than a directory), ignore it</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&#39;div&#39;</span> <span class="o">||</span> <span class="nx">t</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="s1">&#39;children&#39;</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>Recurse upwards until we find the actual directory node</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">while</span><span class="p">(</span><span class="nx">t</span> <span class="o">&amp;&amp;</span> <span class="nx">t</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;dir&#39;</span><span class="p">)</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<p>If we're at the root node, then do nothing (we don't allow collapsing of the whole tree)</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">t</span> <span class="o">||</span> <span class="nx">t</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">id</span> <span class="o">==</span> <span class="s1">&#39;tree&#39;</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>Find the path and toggle the state, saving the state in the localStorage variable</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;rel&#39;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;open&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
    <span class="nx">t</span><span class="p">.</span><span class="nx">className</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s*open/g</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">)</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;docker_openPath:&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">);</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nx">t</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; open&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">)</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">&#39;docker_openPath:&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="nodehtml">
  <h2>
    <a href="#nodehtml" class="pilcrow">&#182;</a>
    nodeHtml
  </h2>
</div>

  </div>
  <div class="body"><p>Constructs the markup for a directory in the tree</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>nodename</span>
      <span class="dox_type">string</span>
      <span>The node name.</span>
    </div>
    <div class="dox_tag_detail">
      <span>node</span>
      <span class="dox_type">object</span>
      <span>Node object of same format as whole tree.</span>
    </div>
    <div class="dox_tag_detail">
      <span>path</span>
      <span class="dox_type">string</span>
      <span>The path form the base to this node</span>
    </div>
    <div class="dox_tag_detail">
      <span>root</span>
      <span class="dox_type">string</span>
      <span>Relative path from current page to root</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">nodeHtml</span><span class="p">(</span><span class="nx">nodename</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">root</span><span class="p">){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>Firstly, figure out whether or not the directory is expanded from localStorage</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">isOpen</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">&#39;docker_openPath:&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">out</span> <span class="o">=</span> <span class="s1">&#39;&lt;div class=&quot;dir&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">isOpen</span> <span class="o">?</span> <span class="s1">&#39; open&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot; rel=&quot;&#39;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">;</span>
  <span class="nx">out</span> <span class="o">+=</span> <span class="s1">&#39;&lt;div class=&quot;nodename&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">nodename</span> <span class="o">+</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">;</span>
  <span class="nx">out</span> <span class="o">+=</span> <span class="s1">&#39;&lt;div class=&quot;children&quot;&gt;&#39;</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>Loop through all child directories first</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">dirs</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">dirs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">node</span><span class="p">.</span><span class="nx">dirs</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">dirs</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="nx">dirs</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">html</span><span class="o">:</span> <span class="nx">nodeHtml</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">node</span><span class="p">.</span><span class="nx">dirs</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">path</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nx">root</span><span class="p">)</span> <span class="p">});</span>
    <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>Have to store them in an array first and then sort them alphabetically here</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="nx">dirs</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">){</span> <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">name</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="p">});</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">dirs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">k</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="nx">out</span> <span class="o">+=</span> <span class="nx">dirs</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">html</span><span class="p">;</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>Now loop through all the child files alphabetically</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">files</span><span class="p">){</span>
    <span class="nx">node</span><span class="p">.</span><span class="nx">files</span><span class="p">.</span><span class="nx">sort</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">){</span>
      <span class="nx">out</span> <span class="o">+=</span> <span class="s1">&#39;&lt;a class=&quot;file&quot; href=&quot;&#39;</span> <span class="o">+</span> <span class="nx">root</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.html&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&lt;/a&gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>Close things off</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="nx">out</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/div&gt;&lt;/div&gt;&#39;</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">out</span><span class="p">;</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="toggletree">
  <h2>
    <a href="#toggletree" class="pilcrow">&#182;</a>
    toggleTree
  </h2>
</div>

  </div>
  <div class="body"><p>Toggles the visibility of the folder tree</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">toggleTree</span><span class="p">(){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>Do the actual toggling by modifying the class on the body element. That way we can get some nice CSS transitions going.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">treeVisible</span><span class="p">){</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s*tree/g</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nx">treeVisible</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; tree&#39;</span><span class="p">;</span>
    <span class="nx">treeVisible</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">treeVisible</span><span class="p">){</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_showTree</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;docker_showTree&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="wireuptabs">
  <h2>
    <a href="#wireuptabs" class="pilcrow">&#182;</a>
    wireUpTabs
  </h2>
</div>

  </div>
  <div class="body"><p>Wires up events on the sidebar tabe</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">wireUpTabs</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">tabEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;sidebar_switch&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="nx">tabEl</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<p>Each tab has a class corresponding of the id of its tab pane</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span>  <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>Ignore text nodes</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
    <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span>
      <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span> <span class="nx">switchTab</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span> <span class="p">};</span>
    <span class="p">}(</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="switchtab">
  <h2>
    <a href="#switchtab" class="pilcrow">&#182;</a>
    switchTab
  </h2>
</div>

  </div>
  <div class="body"><p>Switches tabs in the sidebar</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span>tab</span>
      <span class="dox_type">string</span>
      <span>The ID of the tab to switch to</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">switchTab</span><span class="p">(</span><span class="nx">tab</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">tabEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;sidebar_switch&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="nx">tabEl</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<p>Easiest way to go through tabs without any kind of selector is just to look at the tab bar</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span>  <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>Ignore text nodes</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeType</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<p>Figure out what tab pane this tab button corresponts to</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s.*$/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">t</span> <span class="o">===</span> <span class="nx">tab</span><span class="p">){</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<p>Show the tab pane, select the tab button</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">t</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;block&#39;</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;selected&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; selected&#39;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<p>Hide the tab pane, deselect the tab button</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">t</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
      <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\sselected/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33">&#182;</a>
</div>
<p>Store the last open tab in localStorage</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">)</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_siderbarTab</span> <span class="o">=</span> <span class="nx">tab</span><span class="p">;</span>
<span class="p">}</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="window.onload">
  <h2>
    <a href="#window.onload" class="pilcrow">&#182;</a>
    window.onload
  </h2>
</div>

  </div>
  <div class="body"><p>When the document is ready, make the sidebar and all that jazz</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">makeTree</span><span class="p">(</span><span class="nx">tree</span><span class="p">,</span> <span class="nx">relativeDir</span><span class="p">,</span> <span class="nx">thisFile</span><span class="p">);</span>
  <span class="nx">wireUpTabs</span><span class="p">();</span></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35">&#182;</a>
</div>
<p>Switch to the last viewed sidebar tab if stored, otherwise default to folder tree</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_siderbarTab</span><span class="p">){</span>
    <span class="nx">switchTab</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">docker_siderbarTab</span><span class="p">);</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nx">switchTab</span><span class="p">(</span><span class="s1">&#39;tree&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
